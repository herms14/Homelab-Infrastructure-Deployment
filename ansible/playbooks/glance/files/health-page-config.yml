name: "Health"
columns:
  - size: small
    widgets:
      - type: custom-api
        title: "Weekly Exercise"
        cache: 5m
        url: "http://192.168.40.13:5062/api/activities/weekly"
        template: |
          <div style="font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;">
            <div style="display: flex; align-items: baseline; gap: 8px; margin-bottom: 12px;">
              <span style="font-size: 32px; font-weight: 700; color: {{ .JSON.String "status_color" }};">{{ .JSON.Int "active_days" }}</span>
              <span style="font-size: 14px; color: #71717a;">/7 days active</span>
            </div>
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 8px;">
              <div style="background: rgba(255,255,255,0.03); padding: 8px; border-radius: 6px;">
                <div style="font-size: 10px; color: #71717a;">Activities</div>
                <div style="font-size: 16px; font-weight: 600; color: #d4d4d8;">{{ .JSON.Int "total_activities" }}</div>
              </div>
              <div style="background: rgba(255,255,255,0.03); padding: 8px; border-radius: 6px;">
                <div style="font-size: 10px; color: #71717a;">Time</div>
                <div style="font-size: 16px; font-weight: 600; color: #d4d4d8;">{{ .JSON.String "total_time" }}</div>
              </div>
              <div style="background: rgba(255,255,255,0.03); padding: 8px; border-radius: 6px;">
                <div style="font-size: 10px; color: #71717a;">Rides</div>
                <div style="font-size: 16px; font-weight: 600; color: #60a5fa;">{{ .JSON.Int "rides" }}</div>
              </div>
              <div style="background: rgba(255,255,255,0.03); padding: 8px; border-radius: 6px;">
                <div style="font-size: 10px; color: #71717a;">Gym</div>
                <div style="font-size: 16px; font-weight: 600; color: #a78bfa;">{{ .JSON.Int "gym_sessions" }}</div>
              </div>
            </div>
            {{ if .JSON.String "total_distance" }}
            <div style="font-size: 11px; color: #71717a; margin-top: 8px;">
              Distance: {{ .JSON.String "total_distance" }}
              {{ if gt (.JSON.Int "total_calories") 0 }} &middot; {{ .JSON.Int "total_calories" }} cal{{ end }}
            </div>
            {{ end }}
          </div>

      - type: custom-api
        title: "Weight Progress"
        cache: 10m
        url: "http://192.168.40.13:5062/api/weight"
        template: |
          <div style="font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;">
            {{ if .JSON.Float "current_weight" }}
            <div style="display: flex; align-items: baseline; gap: 8px; margin-bottom: 8px;">
              <span style="font-size: 28px; font-weight: 700; color: #d4d4d8;">{{ .JSON.Float "current_weight" }}</span>
              <span style="font-size: 13px; color: #71717a;">{{ .JSON.String "unit" }}</span>
            </div>
            {{ if .JSON.Float "goal_weight" }}
            <div style="font-size: 11px; color: #71717a; margin-bottom: 8px;">
              Goal: {{ .JSON.Float "goal_weight" }} {{ .JSON.String "unit" }}
            </div>
            {{ end }}
            <div style="display: flex; gap: 12px; font-size: 12px;">
              {{ if .JSON.Float "weekly_change" }}
              <div>
                <span style="color: #71717a;">Week: </span>
                <span style="color: {{ if lt (.JSON.Float "weekly_change") 0.0 }}#22c55e{{ else }}#f59e0b{{ end }}; font-weight: 600;">
                  {{ .JSON.Float "weekly_change" }} {{ .JSON.String "unit" }}
                </span>
              </div>
              {{ end }}
              {{ if .JSON.Float "total_change" }}
              <div>
                <span style="color: #71717a;">Total: </span>
                <span style="color: {{ if lt (.JSON.Float "total_change") 0.0 }}#22c55e{{ else }}#f59e0b{{ end }}; font-weight: 600;">
                  {{ .JSON.Float "total_change" }} {{ .JSON.String "unit" }}
                </span>
              </div>
              {{ end }}
            </div>
            {{ else }}
            <div style="color: #52525b; text-align: center; padding: 20px; font-size: 12px;">
              No weight data yet
            </div>
            {{ end }}
          </div>

      - type: custom-api
        title: "Strava"
        cache: 10m
        url: "http://192.168.40.13:5062/api/strava/status"
        template: |
          <div style="font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;">
            {{ if .JSON.Bool "connected" }}
            <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 8px;">
              <div style="width: 8px; height: 8px; border-radius: 50%; background: #22c55e; box-shadow: 0 0 6px rgba(34,197,94,0.6);"></div>
              <span style="font-size: 12px; color: #22c55e; font-weight: 500;">Connected</span>
            </div>
            <div style="font-size: 12px; color: #d4d4d8; margin-bottom: 4px;">{{ .JSON.String "athlete" }}</div>
            <div style="font-size: 11px; color: #71717a;">
              Last sync: {{ .JSON.String "last_sync" }}<br>
              {{ .JSON.Int "activities_cached" }} activities cached
            </div>
            {{ else }}
            <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 8px;">
              <div style="width: 8px; height: 8px; border-radius: 50%; background: #ef4444;"></div>
              <span style="font-size: 12px; color: #ef4444; font-weight: 500;">Not Connected</span>
            </div>
            <div style="font-size: 11px; color: #71717a;">
              Visit the setup page to connect Strava
            </div>
            {{ end }}
          </div>

      - type: bookmarks
        groups:
          - title: Health Links
            links:
              - title: Strava Dashboard
                url: https://www.strava.com/dashboard
              - title: Health Tracker Setup
                url: http://192.168.40.13:5062/page/setup
              - title: Log Weight
                url: http://192.168.40.13:5062/page/weight

  - size: full
    widgets:
      - type: iframe
        title: "Exercise Calendar"
        source: https://health-api.hrmsmrflrii.xyz/page/calendar
        height: 280

      - type: iframe
        title: "Weight Tracker"
        source: https://health-api.hrmsmrflrii.xyz/page/weight
        height: 420

      - type: iframe
        title: "Strava Stats"
        source: https://health-api.hrmsmrflrii.xyz/page/stats
        height: 500

      - type: iframe
        title: "Recent Activities"
        source: https://health-api.hrmsmrflrii.xyz/page/activities
        height: 380
